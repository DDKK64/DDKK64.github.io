# Lagrange multiplier

Consider a problem of maximizing the function $f(\mathbf{x}) = 0$ under the constraint $g(\mathbf{x})=0$.

$g(\mathbf{x}) = 0$ is a $(D-1)$-demensional surface in the space of $\mathbf{x}$. 

The gradient $\nabla g(\mathbf{x})$ is orthogonal to the surface. This can be shown by taking another point $\mathbf{x}+\boldsymbol{\epsilon}$ lies in the surface such that $g(\mathbf{x}+\boldsymbol{\epsilon}) = 0$.  Using taylor expansion, we have

$$
g(\mathbf{x}+\boldsymbol{\epsilon}) = g(\mathbf{x}) 
+ \boldsymbol{\epsilon}^{\mathsf {T}} \nabla f(\mathbf{x}) + O(|\boldsymbol{\epsilon}|)
$$

In the limit $\|\boldsymbol{\epsilon}\| \rightarrow 0$, $\boldsymbol{\epsilon}$ represents a tangent vector on the surface at $\mathbf{x}$, 
and satisfies $\boldsymbol{\epsilon}^{\mathsf {T}} \nabla f(\mathbf{x}) = 0$.

To find a stationary point $\mathbf{x}^{*}$,
we move $\mathbf{x}$ along the surface towards the direction of the projection of $\nabla f(\mathbf{x})$, 
since such direction always increase the value of $f(\mathbf{x})$. 
Until $\nabla f(\mathbf{x})$ is also orthogonal to the surface, we obtain a stationary point that satisfies

$$
\nabla f(\mathbf{x}) + \lambda \nabla g(\mathbf{x}) = 0
$$

where $\lambda$ is called the Lagrange multiplier.

Therefore, the equivalent problem is to maximize the Lagrangian function without constraints

$$
L(\mathbf{x}, \lambda) = f(\mathbf{x}) + \lambda g(\mathbf{x})
$$

Now consider maximize $f(\mathbf{x})$ under the inequality constraint $g(\mathbf{x}) \ge 0$.

If the stationary point lies on the boundary, we say the constraint is active. The solution will be the same as maximizing $f(\mathbf{x})$ with the equality constraint $g(\mathbf{x}) = 0$, from which we get the stationary condition $\nabla f(\mathbf{x}) + \lambda\nabla g(\mathbf{x}) = 0$.
However, we require that the gradient at the stationary point $\nabla f(\mathbf{x}^\ast)$ points to region $g(\mathbf{x}) < 0$. Otherwise, by moving $\mathbf{x}$ into the region we get a greater value of $f(\mathbf{x})$. 
Since $\nabla g(\mathbf{x})$ always points to the direction where $g(\mathbf{x})$ increases, $\nabla f(\mathbf{x})$ and $\nabla g(\mathbf{x})$ are anti-parallel and $\lambda > 0$.

If the stationary point lies inside the region, we say the constrain is inactive. In this case, the constraint does not have any effect. The solution is the same as the problem of maximizing $f(\mathbf{x})$ without constrain.

Therefore, the problem is equivalent to maximize

$$
L(\mathbf{x}, \lambda) = f(\mathbf{x}) + \lambda g(\mathbf{x})
$$

in two separate cases

$$
\lambda = 0, g(x) \ge 0 \quad \text{or} \quad \lambda > 0, g(x) = 0
$$

which is equivalently given by the KKT conditions:

$$
\begin{align*}
g(\mathbf{x}) &\ge 0 \\
\lambda &\ge 0 \\
\lambda g(\mathbf{x}) &\ge 0 \\
\end{align*}
$$

Note that to minimize $f(\mathbf{x})$, we can simply maximize the $-f(\mathbf{x})$. This is euivalent to minimize

$$
L(\mathbf{x}, \lambda) = f(\mathbf{x}) + \lambda g(\mathbf{x})
$$

with condition

$$
\begin{align*}
g(\mathbf{x}) &\le 0 \\
\lambda &\ge 0 \\
\lambda g(\mathbf{x}) &\le 0 \\
\end{align*}
$$